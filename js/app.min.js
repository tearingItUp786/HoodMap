function loadScript(a){var b=document.createElement("script");b.type="text/javascript",b.src="https://maps.googleapis.com/maps/api/js?key=AIzaSyBGpIQbpJCEJPolgUzC8Qnw9vhLfJl6HM8&signed_in=true&libraries=places",document.body.appendChild(b),b.onload=function(){var b=document.createElement("script");b.type="text/javascript",b.src="js/infobox_packed.js",document.body.appendChild(b),b.onload=a}}function initMap(){var a=[{stylers:[{saturation:-80},{lightness:-30},{gamma:1}]},{featureType:"road",elementType:"geometry",stylers:[{hue:"#f5ae00"},{saturation:40},{lightness:10},{visibility:"simplified"}]},{featureType:"road",elementType:"labels",stylers:[{visibility:"on"},{color:"pink"}]},{featureType:"landscape",elementType:"all",stylers:[{saturation:0}]}],b=new google.maps.StyledMapType(a,{name:"Styled Map"}),c={zoom:10,center:hoodCoordinates,disableDefaultUI:!0,mapTypeControlOptions:{mapTypeIds:[google.maps.MapTypeId.ROADMAP,"map_style"]}};map=new google.maps.Map(document.getElementById("map"),c),map.mapTypes.set("map_style",b),map.setMapTypeId("map_style"),geocoder=new google.maps.Geocoder;var d={disableAutoPan:!1,maxWidth:0,pixelOffset:new google.maps.Size(-140,0),zIndex:null,boxStyle:{width:"100%",maxWidth:"360px",padding:"0px"},closeBoxMargin:"0px 5px 5px 5px",closeBoxURL:"../images/close-box.jpg",infoBoxClearance:new google.maps.Size(1,1),isHidden:!1,pane:"floatPane",enableEventPropagation:!1};infoBox=new InfoBox(d),drawMarkers(),google.maps.event.addListener(infoBox,"closeclick",function(){myListView.currentPlace(null)})}function drawMarkers(){for(var a={url:"../images/my-location-pin.svg",size:new google.maps.Size(30,40)},b=0;b<myListView.placeList().length;b++){var c=myListView.placeList()[b],d=new google.maps.Marker({animation:google.maps.Animation.DROP,position:{lat:c.latitude(),lng:c.longitude()},icon:a});c.marker=d,c.marker.setMap(map),google.maps.event.addListener(c.marker,"click",function(a){return function(b){c=myListView.placeList()[a],myListView.currentPlace(c),map.setCenter(c.marker.getPosition());var d=document.createElement("div");d.id="ib-container",d.className+="ib-container",d.innerHTML='<div class="header"><h1 class="name"><a href="'+c.mobile_url()+'">'+c.name()+'</a></h1><h2 class="location">'+c.location()+'</h2></div><div class="ib-content"><h3><a href="'+c.mobile_url()+'">User Rating: '+c.rating()+"</a></h3><p>"+c.snippet_text()+'</p><img src="'+c.imageURL()+'"/></div>',infoBox.setContent(d),infoBox.open(map,this),scrollList()}}(b))}}function scrollList(){var a=$("#locations"),b=$(".active");$("#locations").stop().animate({scrollTop:b.offset().top-a.offset().top+a.scrollTop()},500),$(".navigation").hasClass("open")&&($(".navigation").toggleClass("open"),$(".navigation").toggleClass("close"),$(".map").toggleClass("open"))}function starSource(a){var b="../images/stars/";switch(a){case 1:b+="1star.png";break;case 1.5:b+="1.5star.png";break;case 2:b+="2star.png";break;case 2.5:b+="2.5star.png";break;case 3:b+="3star.png";break;case 3.5:b+="3.5star.png";break;case 4:b+="4star.png";break;case 4.5:b+="4.5star.png";break;case 5:b+="5star.png";break;default:b="5star.png"}return b}function retrieveYelpData(a,b,c,d){$.ajax({url:c,async:!0,type:"POST",data:{term:a,location:b},dataType:"json",success:function(a){d(a.businesses),console.log(a)},error:function(a,b,c){console.log(b,c),alert("Ajax called failed. Markers will not be made. \nDid you enter a valid location/search term?")}})}function codeAddress(a){var b=document.getElementById("location").value;geocoder.geocode({address:b},function(b,c){c==google.maps.GeocoderStatus.OK?(map.setCenter(b[0].geometry.location),a()):alert("Geocode was not successful for the following reason: "+c+". Are you sure you entered a valid address?")})}function setMapOnAll(a){for(var b=0;b<myListView.placeList().length;b++)myListView.placeList()[b].marker.setMap(a)}function clearMarkers(){infoBox.close(),setMapOnAll(null)}function parseForm(){var a=document.getElementById("location").value,b=document.getElementById("yterm").value;""===b||""===a?alert("Please enter in a valid location/search term"):retrieveYelpData(b,a,"../php/sample.php",function(a){clearMarkers(),myListView.placeList.removeAll(),a.forEach(function(a){var b=new Place(a);myListView.placeList.push(b)}),codeAddress(drawMarkers)})}$(function(){$(".nav-closer").click(function(){$(".navigation").removeClass("close"),$(".navigation").toggleClass("open"),$(".map").toggleClass("open")}),$(".closer").click(function(a){a.preventDefault(),$(".navigation").hasClass("open")&&($(".navigation").toggleClass("open"),$(".navigation").toggleClass("close"),$(".map").toggleClass("open"))})});var hoodCoordinates={lat:49.246292,lng:-123.116226},geocoder,map,infoBox,Place=function(a){this.name=ko.observable(a.name),this.location=ko.observable(a.location.display_address[0]+" "+a.location.display_address[1]+" "+a.location.city+", "+a.location.state_code),this.latitude=ko.observable(a.location.coordinate.latitude),this.longitude=ko.observable(a.location.coordinate.longitude),this.imageURL=ko.observable(a.image_url),this.snippet_text=ko.observable(a.snippet_text),this.mobile_url=ko.observable(a.mobile_url),this.display_phone=ko.observable(a.display_phone),this.rating=ko.observable(a.rating),this.active=ko.observable(!1),this.rating_img_url_large=ko.observable(a.rating_img_url_large),this.fullName=ko.computed(function(){return this.name()+'<br/><img class="star" src="'+starSource(this.rating())+'" alt="star rating"/>'},this)},ListviewModel=function(){var a=this;a.placeList=ko.observableArray([]),a.currentPlace=ko.observable(),function(){retrieveYelpData("","","../php/sample.php",function(b){b.forEach(function(b){var c=new Place(b);a.placeList.push(c)}),loadScript(initMap)})}(),a.displayInfo=function(a){google.maps.event.trigger(a.marker,"click")},a.styling=function(b){return b===a.currentPlace()?"active":""},a.toggle=function(b){b===a.currentPlace()&&a.currentPlace().active(!a.currentPlace().active())},a.scroll=function(){scrollList(),console.log("Scroll called")}};myListView=new ListviewModel,ko.applyBindings(myListView);
//# sourceMappingURL=sourcemap.map